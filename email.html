<script type="text/ng-template" id="email">
    <div flex></div>
    <md-button class="md-accent md-hue-2" ng-click="null">Write a new Email</md-button>
</script>

<div layout="row" flex>
    <md-card flex="33">
        <md-content layout="row" flex>
            <md-tabs md-selected="$ls.selected.tab" flex>
                <md-tab ng-repeat="tab in tabs" ng-click="getEmails(tab)">
                    <md-tab-label>{{ tab.capitalize() }}</md-tab-label>
                    <md-tab-body>
                        <md-list flex>
                            <md-list-item ng-repeat="email in $ls.emails[tab] | objectToArray | orderBy: '-time'" ng-click="openEmail(tab, email.id)"
                                          md-colors="isSelected(tab, email.id) && {background: 'accent-A100'}" class="md-2-line">
                                <div ng-if="tab != 'events'" class="md-avatar-icon fix-icon" md-colors="{background: 'blue-grey-400'}" style="min-width: 36px">
                                    {{ getInitials(email.sender || email.course) }}
                                </div>
                                <div class="md-list-item-text">
                                    <h3>{{ email.title || "No Title" }}</h3>
                                    <p>{{ email.sender || email.course }}</p>
                                </div>
                                <div class="md-list-item-text align-right">
                                    <h3>{{ email.time | timeDistance }}</h3>
                                    <p class="md-caption">{{ email.event }}</p>
                                </div>
                            </md-list-item>
                        </md-list>
                    </md-tab-body>
                </md-tab>
            </md-tabs>
        </md-content>
    </md-card>
    <md-card flex>
        <md-content ng-if="$ls.selected.email[1]" layout-padding flex>
            {{ email = $ls.emails[$ls.selected.email[0]][$ls.selected.email[1]]; '' }}
            <md-card-title>
                <md-card-title-text>
                    <span class="md-display-1">{{ email.title }}</span>
                </md-card-title-text>
            </md-card-title>
            <md-card-header ng-if="$ls.selected.email[0] != 'events'" >
                <div id="email-circle" class="fix-icon" md-colors="{background: 'blue-grey-400'}">
                    {{ getInitials(email.sender || email.course) }}
                </div>
                <md-card-header-text layout="row" layout-align="space-between">
                    <div layout="column">
                        <span class="md-title">{{ email.sender || email.course }}</span>
                        <span class="md-subhead">{{ email.from || "Blackboard Generated" }}</span>
                    </div>
                    <div layout="column" style="text-align: right">
                        <span class="md-title">{{ email.time | timeDistance }}</span>
                        <span class="md-subhead">{{ email.event }}</span>
                    </div>
                </md-card-header-text>
            </md-card-header>
            <md-card-content layout="column" ng-bind-html="$ls.emails.body[$ls.selected.email[1]]">
            </md-card-content>
        </md-content>
    </md-card>
</div>